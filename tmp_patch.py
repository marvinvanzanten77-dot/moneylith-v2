from pathlib import Path
p = Path('src/App.tsx')
text = p.read_text(encoding='utf-8', errors='replace')
old = """  const renderAction = (variant: \"personal\" | \"business\" = \"personal\") => (\n    <StepVooruitblik\n      financialSnapshot={financialSnapshot}\n      spendBuckets={spendBuckets}\n      monthFocus={monthFocus}\n      variant={variant}\n      readOnly={variant === \"business\"}\n    />\n  );\n"""
new = """  const renderAction = (variant: \"personal\" | \"business\" = \"personal\") => {\n    const isBusinessVariant = variant === \"business\";\n    const mapBucketsForNetFree = (sourceBuckets: SpendBucket[], netFreeValue: number): SpendBucket[] => {\n      return sourceBuckets.map((b) => {\n        const shareOfFree = netFreeValue > 0 ? Math.min(b.monthlyAvg / netFreeValue, 5) : undefined;\n        return { ...b, shareOfFree };\n      });\n    };\n\n    const personalNetFree = netIncome - fixedCosts;\n    const businessNetFree = netIncomeBusiness - fixedCostsBusiness;\n\n    const bucketsForVariant = isBusinessVariant\n      ? mapBucketsForNetFree(bucketsBusiness, businessNetFree)\n      : mapBucketsForNetFree(bucketsPersonal, personalNetFree);\n\n    const businessSnapshotForView: FinancialSnapshot = {\n      totalIncome: { value: netIncomeBusiness ?? 0, source: \"manual\" },\n      fixedCostsTotal: { value: fixedCostsBusiness ?? 0, source: \"manual\" },\n      netFree: businessNetFree ?? 0,\n      totalDebt: debtsSummaryBusiness.totalDebt ?? 0,\n      assetsTotal: assetsSummaryBusiness.totalAssets ?? 0,\n      monthlyPressure: debtsSummaryBusiness.totalMinPayment ?? 0,\n      runwayMonths:\n        fixedCostsBusiness > 0 && assetsSummaryBusiness.totalAssets > 0\n          ? Math.floor(assetsSummaryBusiness.totalAssets / fixedCostsBusiness)\n          : null,\n      intent: undefined,\n      focus: null,\n      optimizeCosts: undefined,\n    };\n\n    return (\n      <StepVooruitblik\n        financialSnapshot={isBusinessVariant ? businessSnapshotForView : financialSnapshot}\n        spendBuckets={bucketsForVariant}\n        monthFocus={monthFocus}\n        variant={variant}\n        readOnly={false}\n      />\n    );\n  };\n"""
if old not in text:
    raise SystemExit('old block not found')
p.write_text(text.replace(old, new), encoding='utf-8')
